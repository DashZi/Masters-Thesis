{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"gpuType":"T4","mount_file_id":"10qKqU0SSvVWmSybId0Jcn6W8bP6DfuVU","authorship_tag":"ABX9TyOfQIRxoLUhDlPz8Oz1xPcB"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"79489b6aa3504dc3bf8df51c03e3a751":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0f1801a45e6c4f8e9c1e723ee2318c0a","IPY_MODEL_1113aed666114cdb88ae81812274eb1d","IPY_MODEL_ceff8e384ee64a7fae43823483511e50"],"layout":"IPY_MODEL_6876329e891a4de096e6cdb542d2ede9"}},"0f1801a45e6c4f8e9c1e723ee2318c0a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b8d23230752b4dd1a10ba1b0824a3c0f","placeholder":"​","style":"IPY_MODEL_903f92fcefb042fba99e7a04988307f3","value":"tokenizer_config.json: 100%"}},"1113aed666114cdb88ae81812274eb1d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b40aedfa05d84d9d88b1dbd5f692a7ba","max":25,"min":0,"orientation":"horizontal","style":"IPY_MODEL_aed6386dca5a4a8ea66fc20bb72e2365","value":25}},"ceff8e384ee64a7fae43823483511e50":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f24c6d548f2b4782b900dc1d5d3f24a6","placeholder":"​","style":"IPY_MODEL_e3fd82c3b0a3453194e4ceba178eeb16","value":" 25.0/25.0 [00:00&lt;00:00, 574B/s]"}},"6876329e891a4de096e6cdb542d2ede9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b8d23230752b4dd1a10ba1b0824a3c0f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"903f92fcefb042fba99e7a04988307f3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b40aedfa05d84d9d88b1dbd5f692a7ba":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"aed6386dca5a4a8ea66fc20bb72e2365":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f24c6d548f2b4782b900dc1d5d3f24a6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e3fd82c3b0a3453194e4ceba178eeb16":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e7d88249e90a4c60afcb351abccce665":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6cde0ab1da224a4d9a487f9861017937","IPY_MODEL_bf8d1ea811c443f79a47f04656aa471d","IPY_MODEL_f26ed0c413714fa4ab047ca7d799b25a"],"layout":"IPY_MODEL_045d24aaa3524d5dabba89c36dcb03d9"}},"6cde0ab1da224a4d9a487f9861017937":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_37a0ace89f3d460d8b22122847fb574b","placeholder":"​","style":"IPY_MODEL_57cbc03040bf496ba9bedf09c403f627","value":"vocab.json: 100%"}},"bf8d1ea811c443f79a47f04656aa471d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2d5b5b2ef021406f87f186f626c703d9","max":898823,"min":0,"orientation":"horizontal","style":"IPY_MODEL_79b7fd11b728440185c02d6d4093e49b","value":898823}},"f26ed0c413714fa4ab047ca7d799b25a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_398e031c215e403eabb26a40922c754b","placeholder":"​","style":"IPY_MODEL_549f0971bd6040a4803d35ea1fd2d862","value":" 899k/899k [00:00&lt;00:00, 6.19MB/s]"}},"045d24aaa3524d5dabba89c36dcb03d9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"37a0ace89f3d460d8b22122847fb574b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"57cbc03040bf496ba9bedf09c403f627":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2d5b5b2ef021406f87f186f626c703d9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"79b7fd11b728440185c02d6d4093e49b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"398e031c215e403eabb26a40922c754b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"549f0971bd6040a4803d35ea1fd2d862":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"50d224baaaf74639b108b174cd7e6767":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3576705cc4e34ca0a9bac483b500e069","IPY_MODEL_1e5b0892010a438b98d484763cd4e3e7","IPY_MODEL_95b1a85ad6b24829a11678df7bbf43d2"],"layout":"IPY_MODEL_24739932bce444efa7a249e7a871df52"}},"3576705cc4e34ca0a9bac483b500e069":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_14f5cbdc38614d069f756be613c6f6a9","placeholder":"​","style":"IPY_MODEL_f563a3a8a25040759867467f6b4a4cba","value":"merges.txt: 100%"}},"1e5b0892010a438b98d484763cd4e3e7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_03065f3b1e344fb7922450c54a8deddd","max":456318,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8ab1697f34284a0c9ba357edb27bc10a","value":456318}},"95b1a85ad6b24829a11678df7bbf43d2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cc96063cc4c24800b4df4cab8b2e8262","placeholder":"​","style":"IPY_MODEL_3d6a61e4f56a4711a15e2aacf661b891","value":" 456k/456k [00:00&lt;00:00, 5.98MB/s]"}},"24739932bce444efa7a249e7a871df52":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"14f5cbdc38614d069f756be613c6f6a9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f563a3a8a25040759867467f6b4a4cba":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"03065f3b1e344fb7922450c54a8deddd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8ab1697f34284a0c9ba357edb27bc10a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"cc96063cc4c24800b4df4cab8b2e8262":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3d6a61e4f56a4711a15e2aacf661b891":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"31f37cd81f7c42e9bd63a087b8fc6eb6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ba3da9b3729f4bf89723ade3b1d1ca76","IPY_MODEL_cb361b81adc0491987c9362c63415cf7","IPY_MODEL_547110ad417149f2b5af8327ad24acff"],"layout":"IPY_MODEL_b226527e4fc64c71b1b44a4f0aed84bc"}},"ba3da9b3729f4bf89723ade3b1d1ca76":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5d6e867554454f868dedefa1674073e0","placeholder":"​","style":"IPY_MODEL_3af56787a5154c0fbf0ec2d5f27875d5","value":"tokenizer.json: 100%"}},"cb361b81adc0491987c9362c63415cf7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_c7afc8550faa46c384e49576fbd12993","max":1355863,"min":0,"orientation":"horizontal","style":"IPY_MODEL_1e60e87a95d9451b85992b0873712540","value":1355863}},"547110ad417149f2b5af8327ad24acff":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0abe2638beeb40ccb5c15ebd0e27eb47","placeholder":"​","style":"IPY_MODEL_d17e489531114a2388236cce9d16c238","value":" 1.36M/1.36M [00:00&lt;00:00, 16.3MB/s]"}},"b226527e4fc64c71b1b44a4f0aed84bc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5d6e867554454f868dedefa1674073e0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3af56787a5154c0fbf0ec2d5f27875d5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c7afc8550faa46c384e49576fbd12993":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1e60e87a95d9451b85992b0873712540":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0abe2638beeb40ccb5c15ebd0e27eb47":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d17e489531114a2388236cce9d16c238":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3cba9f8e5bcd40e9bc5d13aaaca8885f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e19c4b1ca8ca43fa8e7d96d82e75d777","IPY_MODEL_94c5f017a39648ec89f1c4c3730685c6","IPY_MODEL_9ca182a1a9604f7d923ec98d45022a71"],"layout":"IPY_MODEL_f1f8234b43c44099b4634fa6af2aca23"}},"e19c4b1ca8ca43fa8e7d96d82e75d777":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_18dac4d42ef64ef9bc197c74488ab1b6","placeholder":"​","style":"IPY_MODEL_78ee3f4a79ab42259a6c6046f2088263","value":"config.json: 100%"}},"94c5f017a39648ec89f1c4c3730685c6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_24ad90a597a5471588c92e2397237009","max":481,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e56f8cb297b645f2b0d213bc31f6ceea","value":481}},"9ca182a1a9604f7d923ec98d45022a71":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7c5f43967270495e8716557a9da6f2ef","placeholder":"​","style":"IPY_MODEL_d2fc97c8740f44479931dd8afef0ed07","value":" 481/481 [00:00&lt;00:00, 16.6kB/s]"}},"f1f8234b43c44099b4634fa6af2aca23":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"18dac4d42ef64ef9bc197c74488ab1b6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"78ee3f4a79ab42259a6c6046f2088263":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"24ad90a597a5471588c92e2397237009":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e56f8cb297b645f2b0d213bc31f6ceea":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7c5f43967270495e8716557a9da6f2ef":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d2fc97c8740f44479931dd8afef0ed07":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"oiLV8eS6-9gP","executionInfo":{"status":"ok","timestamp":1748609176228,"user_tz":-120,"elapsed":13267,"user":{"displayName":"Daria Zhukova","userId":"13302040269195955520"}},"outputId":"22e34eed-f8d8-4bdd-f140-64deb3974e9a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BHdlBQXW1ThE","executionInfo":{"status":"ok","timestamp":1748609232755,"user_tz":-120,"elapsed":55077,"user":{"displayName":"Daria Zhukova","userId":"13302040269195955520"}},"outputId":"a17e2540-5c43-4f02-cd5d-a6f14f829e9c"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: datasets in /usr/local/lib/python3.11/dist-packages (2.14.4)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.11/dist-packages (from datasets) (2.0.2)\n","Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (18.1.0)\n","Requirement already satisfied: dill<0.3.8,>=0.3.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (0.3.7)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.11/dist-packages (from datasets) (2.2.2)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (2.32.3)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.11/dist-packages (from datasets) (4.67.1)\n","Requirement already satisfied: xxhash in /usr/local/lib/python3.11/dist-packages (from datasets) (3.5.0)\n","Requirement already satisfied: multiprocess in /usr/local/lib/python3.11/dist-packages (from datasets) (0.70.15)\n","Requirement already satisfied: fsspec>=2021.11.1 in /usr/local/lib/python3.11/dist-packages (from fsspec[http]>=2021.11.1->datasets) (2025.3.2)\n","Requirement already satisfied: aiohttp in /usr/local/lib/python3.11/dist-packages (from datasets) (3.11.15)\n","Requirement already satisfied: huggingface-hub<1.0.0,>=0.14.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (0.31.4)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.11/dist-packages (from datasets) (24.2)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.11/dist-packages (from datasets) (6.0.2)\n","Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (2.6.1)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (1.3.2)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (25.3.0)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (1.6.0)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (6.4.4)\n","Requirement already satisfied: propcache>=0.2.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (0.3.1)\n","Requirement already satisfied: yarl<2.0,>=1.17.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (1.20.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from huggingface-hub<1.0.0,>=0.14.0->datasets) (3.18.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub<1.0.0,>=0.14.0->datasets) (4.13.2)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests>=2.19.0->datasets) (3.4.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests>=2.19.0->datasets) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests>=2.19.0->datasets) (2.4.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests>=2.19.0->datasets) (2025.4.26)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2.9.0.post0)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2025.2)\n","Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2025.2)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.8.2->pandas->datasets) (1.17.0)\n","Collecting scikit-multilearn\n","  Downloading scikit_multilearn-0.2.0-py3-none-any.whl.metadata (6.0 kB)\n","\u001b[31mERROR: Could not find a version that satisfies the requirement as (from versions: none)\u001b[0m\u001b[31m\n","\u001b[0m\u001b[31mERROR: No matching distribution found for as\u001b[0m\u001b[31m\n","\u001b[0mCollecting sklearn.preprocessing\n","  Downloading sklearn_preprocessing-0.1.0-py3-none-any.whl.metadata (70 bytes)\n","Downloading sklearn_preprocessing-0.1.0-py3-none-any.whl (10 kB)\n","Installing collected packages: sklearn.preprocessing\n","Successfully installed sklearn.preprocessing-0.1.0\n"]}],"source":["import datetime\n","import json\n","import os.path\n","import pickle\n","from copy import deepcopy\n","\n","import matplotlib.pyplot as plt\n","import pandas as pd\n","import torch\n","import transformers\n","!pip install datasets\n","from datasets import Dataset\n","from sklearn.metrics import f1_score\n","!pip install scikit-multilearn as sklearn\n","!pip install sklearn.preprocessing\n","from sklearn.metrics import f1_score\n","from sklearn.preprocessing import MultiLabelBinarizer\n","#from skmultilearn.model_selection import IterativeStratification\n","from torch.nn import BCEWithLogitsLoss\n","from transformers import RobertaTokenizer, RobertaForSequenceClassification, RobertaConfig, TrainingArguments, Trainer, \\\n","    TrainerState, TrainerControl"]},{"cell_type":"code","source":["!pip install transformers torch joblib"],"metadata":{"id":"0Eo7WVILl5fz","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1748609361389,"user_tz":-120,"elapsed":128644,"user":{"displayName":"Daria Zhukova","userId":"13302040269195955520"}},"outputId":"efe1aa53-a62b-4535-c366-0f764d2770e4"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: transformers in /usr/local/lib/python3.11/dist-packages (4.52.2)\n","Requirement already satisfied: torch in /usr/local/lib/python3.11/dist-packages (2.6.0+cu124)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.11/dist-packages (1.5.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from transformers) (3.18.0)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.30.0 in /usr/local/lib/python3.11/dist-packages (from transformers) (0.31.4)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.11/dist-packages (from transformers) (2.0.2)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from transformers) (24.2)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.11/dist-packages (from transformers) (6.0.2)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.11/dist-packages (from transformers) (2024.11.6)\n","Requirement already satisfied: requests in /usr/local/lib/python3.11/dist-packages (from transformers) (2.32.3)\n","Requirement already satisfied: tokenizers<0.22,>=0.21 in /usr/local/lib/python3.11/dist-packages (from transformers) (0.21.1)\n","Requirement already satisfied: safetensors>=0.4.3 in /usr/local/lib/python3.11/dist-packages (from transformers) (0.5.3)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.11/dist-packages (from transformers) (4.67.1)\n","Requirement already satisfied: typing-extensions>=4.10.0 in /usr/local/lib/python3.11/dist-packages (from torch) (4.13.2)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.11/dist-packages (from torch) (3.4.2)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.11/dist-packages (from torch) (3.1.6)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.11/dist-packages (from torch) (2025.3.2)\n","Collecting nvidia-cuda-nvrtc-cu12==12.4.127 (from torch)\n","  Downloading nvidia_cuda_nvrtc_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-cuda-runtime-cu12==12.4.127 (from torch)\n","  Downloading nvidia_cuda_runtime_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-cuda-cupti-cu12==12.4.127 (from torch)\n","  Downloading nvidia_cuda_cupti_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-cudnn-cu12==9.1.0.70 (from torch)\n","  Downloading nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-cublas-cu12==12.4.5.8 (from torch)\n","  Downloading nvidia_cublas_cu12-12.4.5.8-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-cufft-cu12==11.2.1.3 (from torch)\n","  Downloading nvidia_cufft_cu12-11.2.1.3-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-curand-cu12==10.3.5.147 (from torch)\n","  Downloading nvidia_curand_cu12-10.3.5.147-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-cusolver-cu12==11.6.1.9 (from torch)\n","  Downloading nvidia_cusolver_cu12-11.6.1.9-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-cusparse-cu12==12.3.1.170 (from torch)\n","  Downloading nvidia_cusparse_cu12-12.3.1.170-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)\n","Requirement already satisfied: nvidia-cusparselt-cu12==0.6.2 in /usr/local/lib/python3.11/dist-packages (from torch) (0.6.2)\n","Requirement already satisfied: nvidia-nccl-cu12==2.21.5 in /usr/local/lib/python3.11/dist-packages (from torch) (2.21.5)\n","Requirement already satisfied: nvidia-nvtx-cu12==12.4.127 in /usr/local/lib/python3.11/dist-packages (from torch) (12.4.127)\n","Collecting nvidia-nvjitlink-cu12==12.4.127 (from torch)\n","  Downloading nvidia_nvjitlink_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)\n","Requirement already satisfied: triton==3.2.0 in /usr/local/lib/python3.11/dist-packages (from torch) (3.2.0)\n","Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.11/dist-packages (from torch) (1.13.1)\n","Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.11/dist-packages (from sympy==1.13.1->torch) (1.3.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.11/dist-packages (from jinja2->torch) (3.0.2)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests->transformers) (3.4.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests->transformers) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests->transformers) (2.4.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests->transformers) (2025.4.26)\n","Downloading nvidia_cublas_cu12-12.4.5.8-py3-none-manylinux2014_x86_64.whl (363.4 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m363.4/363.4 MB\u001b[0m \u001b[31m3.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cuda_cupti_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (13.8 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m13.8/13.8 MB\u001b[0m \u001b[31m23.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cuda_nvrtc_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (24.6 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m24.6/24.6 MB\u001b[0m \u001b[31m58.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cuda_runtime_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (883 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m883.7/883.7 kB\u001b[0m \u001b[31m48.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl (664.8 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m664.8/664.8 MB\u001b[0m \u001b[31m2.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cufft_cu12-11.2.1.3-py3-none-manylinux2014_x86_64.whl (211.5 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m211.5/211.5 MB\u001b[0m \u001b[31m6.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_curand_cu12-10.3.5.147-py3-none-manylinux2014_x86_64.whl (56.3 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m56.3/56.3 MB\u001b[0m \u001b[31m10.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cusolver_cu12-11.6.1.9-py3-none-manylinux2014_x86_64.whl (127.9 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m127.9/127.9 MB\u001b[0m \u001b[31m9.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cusparse_cu12-12.3.1.170-py3-none-manylinux2014_x86_64.whl (207.5 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m207.5/207.5 MB\u001b[0m \u001b[31m5.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_nvjitlink_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (21.1 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m21.1/21.1 MB\u001b[0m \u001b[31m52.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: nvidia-nvjitlink-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, nvidia-cusparse-cu12, nvidia-cudnn-cu12, nvidia-cusolver-cu12\n","  Attempting uninstall: nvidia-nvjitlink-cu12\n","    Found existing installation: nvidia-nvjitlink-cu12 12.5.82\n","    Uninstalling nvidia-nvjitlink-cu12-12.5.82:\n","      Successfully uninstalled nvidia-nvjitlink-cu12-12.5.82\n","  Attempting uninstall: nvidia-curand-cu12\n","    Found existing installation: nvidia-curand-cu12 10.3.6.82\n","    Uninstalling nvidia-curand-cu12-10.3.6.82:\n","      Successfully uninstalled nvidia-curand-cu12-10.3.6.82\n","  Attempting uninstall: nvidia-cufft-cu12\n","    Found existing installation: nvidia-cufft-cu12 11.2.3.61\n","    Uninstalling nvidia-cufft-cu12-11.2.3.61:\n","      Successfully uninstalled nvidia-cufft-cu12-11.2.3.61\n","  Attempting uninstall: nvidia-cuda-runtime-cu12\n","    Found existing installation: nvidia-cuda-runtime-cu12 12.5.82\n","    Uninstalling nvidia-cuda-runtime-cu12-12.5.82:\n","      Successfully uninstalled nvidia-cuda-runtime-cu12-12.5.82\n","  Attempting uninstall: nvidia-cuda-nvrtc-cu12\n","    Found existing installation: nvidia-cuda-nvrtc-cu12 12.5.82\n","    Uninstalling nvidia-cuda-nvrtc-cu12-12.5.82:\n","      Successfully uninstalled nvidia-cuda-nvrtc-cu12-12.5.82\n","  Attempting uninstall: nvidia-cuda-cupti-cu12\n","    Found existing installation: nvidia-cuda-cupti-cu12 12.5.82\n","    Uninstalling nvidia-cuda-cupti-cu12-12.5.82:\n","      Successfully uninstalled nvidia-cuda-cupti-cu12-12.5.82\n","  Attempting uninstall: nvidia-cublas-cu12\n","    Found existing installation: nvidia-cublas-cu12 12.5.3.2\n","    Uninstalling nvidia-cublas-cu12-12.5.3.2:\n","      Successfully uninstalled nvidia-cublas-cu12-12.5.3.2\n","  Attempting uninstall: nvidia-cusparse-cu12\n","    Found existing installation: nvidia-cusparse-cu12 12.5.1.3\n","    Uninstalling nvidia-cusparse-cu12-12.5.1.3:\n","      Successfully uninstalled nvidia-cusparse-cu12-12.5.1.3\n","  Attempting uninstall: nvidia-cudnn-cu12\n","    Found existing installation: nvidia-cudnn-cu12 9.3.0.75\n","    Uninstalling nvidia-cudnn-cu12-9.3.0.75:\n","      Successfully uninstalled nvidia-cudnn-cu12-9.3.0.75\n","  Attempting uninstall: nvidia-cusolver-cu12\n","    Found existing installation: nvidia-cusolver-cu12 11.6.3.83\n","    Uninstalling nvidia-cusolver-cu12-11.6.3.83:\n","      Successfully uninstalled nvidia-cusolver-cu12-11.6.3.83\n","Successfully installed nvidia-cublas-cu12-12.4.5.8 nvidia-cuda-cupti-cu12-12.4.127 nvidia-cuda-nvrtc-cu12-12.4.127 nvidia-cuda-runtime-cu12-12.4.127 nvidia-cudnn-cu12-9.1.0.70 nvidia-cufft-cu12-11.2.1.3 nvidia-curand-cu12-10.3.5.147 nvidia-cusolver-cu12-11.6.1.9 nvidia-cusparse-cu12-12.3.1.170 nvidia-nvjitlink-cu12-12.4.127\n"]},{"output_type":"display_data","data":{"application/vnd.colab-display-data+json":{"pip_warning":{"packages":["nvidia"]},"id":"c432f3022c624a44b3a7c78a9816a207"}},"metadata":{}}]},{"cell_type":"code","source":["!pip install scikit-multilearn\n","from skmultilearn.model_selection import IterativeStratification"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HUg8bm8L4YSb","executionInfo":{"status":"ok","timestamp":1748609365628,"user_tz":-120,"elapsed":4236,"user":{"displayName":"Daria Zhukova","userId":"13302040269195955520"}},"outputId":"1d80bc9a-b599-49b5-dc0e-e5b96f592354"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting scikit-multilearn\n","  Using cached scikit_multilearn-0.2.0-py3-none-any.whl.metadata (6.0 kB)\n","Downloading scikit_multilearn-0.2.0-py3-none-any.whl (89 kB)\n","\u001b[?25l   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/89.4 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m89.4/89.4 kB\u001b[0m \u001b[31m4.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: scikit-multilearn\n","Successfully installed scikit-multilearn-0.2.0\n"]}]},{"cell_type":"code","source":["class LogCallback(transformers.TrainerCallback):\n","    def __init__(self, trainer):\n","        super().__init__()\n","        self._trainer = trainer\n","        self.init_time = datetime.datetime.now().isoformat()\n","        self.file_name = f\"log-train-{self.init_time}.jsonl\"\n","\n","    def on_log(self, args: TrainingArguments, state: TrainerState, control: TrainerControl, **kwargs):\n","        super().on_log(args, state, control, **kwargs)\n","        with open(os.path.join(args.logging_dir, self.file_name), \"a+\") as out_file:\n","            out_file.write(json.dumps(state.log_history[-1]))\n","            out_file.write(\"\\n\")\n","\n","    def on_epoch_end(self, args: TrainingArguments, state: TrainerState, control: TrainerControl, **kwargs):\n","        if control.should_evaluate:\n","            control_copy = deepcopy(control)\n","            self._trainer.evaluate(eval_dataset=self._trainer.train_dataset, metric_key_prefix=\"train\")\n","            return control_copy"],"metadata":{"id":"asfGbeNz1d3a"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["LogCallback writes every log event into a JSON Lines file under your logging_dir.\n","\n","At the end of each epoch, if you normally evaluate, it also runs an evaluation on your train data, so you capture training-set metrics alongside validation metrics.\n","\n","Deep-copying the control object makes sure you don’t inadvertently short-circuit the Trainer’s built-in logic."],"metadata":{"id":"zMq9Mw_jY98r"}},{"cell_type":"code","source":["def train_and_evaluate(model, tokenizer, mlb, train_dataset, val_dataset, num_epochs):\n","    training_args = TrainingArguments(\n","        output_dir='./models',\n","        per_device_train_batch_size=64,\n","        per_device_eval_batch_size=64,\n","        learning_rate=5e-5,\n","        do_train=True,\n","        do_eval=True,\n","        eval_strategy='epoch',\n","        eval_steps=1,\n","        num_train_epochs=num_epochs,\n","        logging_strategy='steps',\n","        logging_dir=\"./logs\",\n","        logging_steps=10,\n","        remove_unused_columns=False,\n","        save_strategy='epoch',\n","    )\n","\n","    loss_func = BCEWithLogitsLoss()\n","    trainer = Trainer(\n","        args=training_args,\n","        model=model,\n","        train_dataset=train_dataset,\n","        eval_dataset=val_dataset,\n","        compute_loss_func=lambda outputs, labels, num_items_in_batch: loss_func(outputs.logits, labels),\n","        compute_metrics=lambda pred: {\"f1\": f1_score(pred.label_ids, torch.sigmoid(torch.tensor(pred.predictions)).round(), average=\"macro\"),},\n","        data_collator=lambda d: collate_data(d, tokenizer, mlb)\n","    )\n","\n","    trainer.add_callback(LogCallback(trainer))\n","\n","    trainer.train()"],"metadata":{"id":"inze2Rk01h1Q"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["This small utility function is what you hand to your PyTorch DataLoader as its collate_fn: it takes a list of raw examples and turns them into one batched tensor dict that you can feed straight into your model."],"metadata":{"id":"y2fXlgERacvh"}},{"cell_type":"code","source":["def collate_data(data, tokenizer, mlb):\n","    texts = [d[\"context\"] for d in data]\n","    labels = mlb.transform([d[\"DA_list\"] for d in data])\n","\n","    batch = tokenizer(texts,\n","            add_special_tokens=True,\n","            padding=\"longest\",\n","            truncation=False,\n","            return_attention_mask=True,\n","            return_tensors='pt')\n","\n","    batch[\"labels\"] = torch.tensor(labels, dtype=torch.float32)\n","    return batch"],"metadata":{"id":"YuoABaDf1k66"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["`data` is a list of examples, where each example `d` is a dict\n","with at least two keys:\n","\n","* \"context\": the input text you want to classify\n","\n","* \"DA_list\": the list of true labels (e.g. [\"greeting\", \"question\"]) for that text"],"metadata":{"id":"RHnmwPGZauTG"}},{"cell_type":"code","source":["def k_fold_cross_validation(dataframe, tokenizer, k=5, epochs=10):\n","    mlb = MultiLabelBinarizer()\n","    labels = mlb.fit_transform(dataframe['DA_list'])\n","\n","    stratifier = IterativeStratification(n_splits=k, order=1)\n","    splits = stratifier.split(dataframe, labels)\n","\n","    device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')\n","\n","    for fold_number, (train_index, test_index) in enumerate(splits):\n","        train_df = dataframe.iloc[train_index]\n","\n","        test_df = dataframe.iloc[test_index]\n","        train_dataset = Dataset.from_pandas(train_df)\n","        test_dataset = Dataset.from_pandas(test_df)\n","\n","        # Model setup\n","        model = RobertaForSequenceClassification(\n","            RobertaConfig.from_pretrained('roberta-base', num_labels=len(mlb.classes_))\n","        )\n","        model.to(device)\n","\n","        # Train and evaluate model across specified epochs\n","        train_and_evaluate(model, tokenizer, mlb, train_dataset, test_dataset, epochs)"],"metadata":{"id":"_JwV5lei1oWS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def compare_label_distributions(label_counts, labels):\n","    results = []\n","\n","    for i, fold_i in enumerate(label_counts):\n","        for j, fold_j in enumerate(label_counts):\n","            if i >= j:  # Avoid duplicate comparisons\n","                continue\n","\n","            # Compare label distributions\n","            diff_train = {label: abs(fold_i['train'].get(label, 0) - fold_j['train'].get(label, 0)) for label in labels}\n","            diff_test = {label: abs(fold_i['test'].get(label, 0) - fold_j['test'].get(label, 0)) for label in labels}\n","\n","            results.append({\n","                'Fold_1': fold_i['fold'],\n","                'Fold_2': fold_j['fold'],\n","                'Train_Diff': diff_train,\n","                'Test_Diff': diff_test,\n","            })\n","\n","    # Convert to a DataFrame for easier visualization and saving\n","    comparison_df = pd.DataFrame(results)\n","    return comparison_df"],"metadata":{"id":"MxRurULv1qql"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def save_results_to_file(data, file_path, file_format='csv'):\n","    if file_format == 'csv':\n","        if isinstance(data, pd.DataFrame):\n","            data.to_csv(file_path, index=False)\n","        else:\n","            pd.DataFrame(data).to_csv(file_path, index=False)\n","    elif file_format == 'json':\n","        with open(file_path, 'w') as f:\n","            json.dump(data, f, indent=4)\n","    else:\n","        raise ValueError(\"Unsupported file format. Use 'csv' or 'json'.\")"],"metadata":{"id":"ED8eCsFF1upr"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def plot_label_distribution(label_counts, labels):\n","    train_counts = {label: [] for label in labels}\n","    test_counts = {label: [] for label in labels}\n","\n","    for count in label_counts:\n","        for label in labels:\n","            train_counts[label].append(count['train'].get(label, 0))\n","            test_counts[label].append(count['test'].get(label, 0))\n","\n","    fig, ax = plt.subplots(figsize=(14, 8))\n","    for label in labels:\n","        ax.plot(range(1, len(label_counts) + 1), train_counts[label], label=f'Train {label}')\n","        ax.plot(range(1, len(label_counts) + 1), test_counts[label], label=f'Test {label}', linestyle='--')\n","\n","    ax.set_xlabel('Fold Number')\n","    ax.set_ylabel('Label Count')\n","    ax.set_title('Label Distribution Across Folds')\n","    ax.legend()\n","    plt.show()"],"metadata":{"id":"IYQI_Af11wzW"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def load_dataset(path):\n","    dataframe = pd.read_csv(path)\n","    dataframe['context'] = dataframe['context'].fillna('')  # Replace NaN with empty string\n","    dataframe['context'] = dataframe['context'].astype(str)  # Ensure all entries are strings\n","    dataframe['DA_list'] = dataframe['DA'].apply(\n","        lambda x: list(sorted(set(x.replace(\" \", \"\").split(',')))) if isinstance(x, str) else [])\n","\n","    return dataframe"],"metadata":{"id":"iC-bqG6_1zEt"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["57207cb4b386d722e7bacf22c2584befb6c34e78\n","\n"],"metadata":{"id":"nj4rB9rXZIbv"}},{"cell_type":"markdown","source":["// Похоже нужно сначала загрузить полномасштабную тренировку модели на 30 эпохах, тогда получить все логи и выбрать лучшие чекпоинты"],"metadata":{"id":"Zh6AksDuXsQP"}},{"cell_type":"code","source":["def main():\n","    if not os.path.exists(\"/content/drive/MyDrive/HCI Master courses/THESIS/logs\"):\n","        os.mkdir(\"/content/drive/MyDrive/HCI Master courses/THESIS/logs\")\n","\n","    #data_test = load_dataset('data/optimal_test.csv')\n","    #data_train = load_dataset('data/optimal_train.csv')\n","    data_test = load_dataset('/content/drive/MyDrive/HCI Master courses/THESIS/optimal_test.csv')\n","    data_train = load_dataset('/content/drive/MyDrive/HCI Master courses/THESIS/optimal_train.csv')\n","\n","    mlb = MultiLabelBinarizer()\n","    mlb.fit(data_train['DA_list'])\n","    mlb.fit(data_test['DA_list'])\n","\n","    #with open(\"/content/models/mlb.pkl\", \"wb\") as f:\n","        #pickle.dump(mlb, f)\n","\n","    dataset_train = Dataset.from_pandas(data_train)\n","    dataset_test = Dataset.from_pandas(data_test)\n","\n","    device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')\n","    tokenizer = RobertaTokenizer.from_pretrained('roberta-base')\n","    model = RobertaForSequenceClassification(\n","        RobertaConfig.from_pretrained('roberta-base', num_labels=len(mlb.classes_))\n","    )\n","    model.to(device)\n","\n","    train_and_evaluate(model, tokenizer, mlb, dataset_train, dataset_test, 30)#30\n","\n","    # Execute\n","    # k_fold_cross_validation(dataframe, tokenizer, k=5, epochs=10)\n","\n","if __name__ == '__main__':\n","    main()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":533},"id":"pP4HT9rX12RV","outputId":"3425a99b-9eed-4517-b23b-3e6d9cddf2b8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["\u001b[34m\u001b[1mwandb\u001b[0m: \u001b[33mWARNING\u001b[0m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.\n","\u001b[34m\u001b[1mwandb\u001b[0m: Currently logged in as: \u001b[33mdarya-zhookova\u001b[0m (\u001b[33mdarya-zhookova-bauhaus-university-weimar\u001b[0m) to \u001b[32mhttps://api.wandb.ai\u001b[0m. Use \u001b[1m`wandb login --relogin`\u001b[0m to force relogin\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Tracking run with wandb version 0.19.10"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Run data is saved locally in <code>/content/wandb/run-20250429_205143-l5uzmeyq</code>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Syncing run <strong><a href='https://wandb.ai/darya-zhookova-bauhaus-university-weimar/huggingface/runs/l5uzmeyq' target=\"_blank\">./models</a></strong> to <a href='https://wandb.ai/darya-zhookova-bauhaus-university-weimar/huggingface' target=\"_blank\">Weights & Biases</a> (<a href='https://wandb.me/developer-guide' target=\"_blank\">docs</a>)<br>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View project at <a href='https://wandb.ai/darya-zhookova-bauhaus-university-weimar/huggingface' target=\"_blank\">https://wandb.ai/darya-zhookova-bauhaus-university-weimar/huggingface</a>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":[" View run at <a href='https://wandb.ai/darya-zhookova-bauhaus-university-weimar/huggingface/runs/l5uzmeyq' target=\"_blank\">https://wandb.ai/darya-zhookova-bauhaus-university-weimar/huggingface/runs/l5uzmeyq</a>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='2578' max='7440' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [2578/7440 45:42 < 1:26:16, 0.94 it/s, Epoch 10.39/30]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Epoch</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>F1</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>1</td>\n","      <td>0.138500</td>\n","      <td>0.132440</td>\n","      <td>0.119157</td>\n","    </tr>\n","    <tr>\n","      <td>2</td>\n","      <td>0.094300</td>\n","      <td>0.097404</td>\n","      <td>0.283828</td>\n","    </tr>\n","    <tr>\n","      <td>3</td>\n","      <td>0.090400</td>\n","      <td>0.088729</td>\n","      <td>0.313186</td>\n","    </tr>\n","    <tr>\n","      <td>4</td>\n","      <td>0.076600</td>\n","      <td>0.082866</td>\n","      <td>0.372220</td>\n","    </tr>\n","    <tr>\n","      <td>5</td>\n","      <td>0.061800</td>\n","      <td>0.079964</td>\n","      <td>0.400305</td>\n","    </tr>\n","    <tr>\n","      <td>6</td>\n","      <td>0.054400</td>\n","      <td>0.082638</td>\n","      <td>0.430575</td>\n","    </tr>\n","    <tr>\n","      <td>7</td>\n","      <td>0.054000</td>\n","      <td>0.079842</td>\n","      <td>0.445441</td>\n","    </tr>\n","    <tr>\n","      <td>8</td>\n","      <td>0.043900</td>\n","      <td>0.084302</td>\n","      <td>0.486894</td>\n","    </tr>\n","    <tr>\n","      <td>9</td>\n","      <td>0.043900</td>\n","      <td>0.083019</td>\n","      <td>0.540202</td>\n","    </tr>\n","    <tr>\n","      <td>10</td>\n","      <td>0.040300</td>\n","      <td>0.088448</td>\n","      <td>0.545874</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}}]},{"cell_type":"markdown","source":["Ждем, когда пробегутся все 30 эпох, чтобы получить все лог файлы и все папки с чекпоинтами и выбрать лучшие для валидации."],"metadata":{"id":"DNqFExnUgrai"}},{"cell_type":"code","source":["DRIVE_ROOT = \"/content\"\n","!find \"{DRIVE_ROOT}\" -type f -name \"mlb.pkl\"\n","!find \"{DRIVE_ROOT}\" -type d -name \"checkpoint*\""],"metadata":{"id":"D8I9sbrQU8Hq","executionInfo":{"status":"ok","timestamp":1745957643262,"user_tz":-120,"elapsed":80020,"user":{"displayName":"Daria Zhukova","userId":"13302040269195955520"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"51665755-034c-422f-e3ac-f4ed735ae622"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/models/mlb.pkl\n","/content/models/checkpoint-2232\n","/content/models/checkpoint-1736\n","/content/models/checkpoint-744\n","/content/models/checkpoint-1984\n","/content/models/checkpoint-992\n","/content/models/checkpoint-248\n","/content/models/checkpoint-1488\n","/content/models/checkpoint-1240\n","/content/models/checkpoint-2480\n","/content/models/checkpoint-496\n"]}]},{"cell_type":"markdown","source":["// Необходимо узнать, какая папка из чекпоинтов мне нужна и как они формируются"],"metadata":{"id":"w9Ss4IIMcgRb"}},{"cell_type":"markdown","source":["# RUN test"],"metadata":{"id":"RPt_hy6cshyt"}},{"cell_type":"code","source":["import joblib\n","import torch\n","from transformers import RobertaTokenizer, RobertaForSequenceClassification\n","\n","MLB_PATH   = \"/content/drive/MyDrive/HCI Master courses/THESIS/mlb.pkl\"\n","CHECKP_DIR = \"/content/drive/MyDrive/HCI Master courses/THESIS/checkpoint-7440\"\n","\n","mlb = joblib.load(MLB_PATH)\n","tokenizer = RobertaTokenizer.from_pretrained(\"roberta-base\")\n","model     = RobertaForSequenceClassification.from_pretrained(CHECKP_DIR)\n","model.eval()"],"metadata":{"id":"PUADGCQgZF_v","colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["79489b6aa3504dc3bf8df51c03e3a751","0f1801a45e6c4f8e9c1e723ee2318c0a","1113aed666114cdb88ae81812274eb1d","ceff8e384ee64a7fae43823483511e50","6876329e891a4de096e6cdb542d2ede9","b8d23230752b4dd1a10ba1b0824a3c0f","903f92fcefb042fba99e7a04988307f3","b40aedfa05d84d9d88b1dbd5f692a7ba","aed6386dca5a4a8ea66fc20bb72e2365","f24c6d548f2b4782b900dc1d5d3f24a6","e3fd82c3b0a3453194e4ceba178eeb16","e7d88249e90a4c60afcb351abccce665","6cde0ab1da224a4d9a487f9861017937","bf8d1ea811c443f79a47f04656aa471d","f26ed0c413714fa4ab047ca7d799b25a","045d24aaa3524d5dabba89c36dcb03d9","37a0ace89f3d460d8b22122847fb574b","57cbc03040bf496ba9bedf09c403f627","2d5b5b2ef021406f87f186f626c703d9","79b7fd11b728440185c02d6d4093e49b","398e031c215e403eabb26a40922c754b","549f0971bd6040a4803d35ea1fd2d862","50d224baaaf74639b108b174cd7e6767","3576705cc4e34ca0a9bac483b500e069","1e5b0892010a438b98d484763cd4e3e7","95b1a85ad6b24829a11678df7bbf43d2","24739932bce444efa7a249e7a871df52","14f5cbdc38614d069f756be613c6f6a9","f563a3a8a25040759867467f6b4a4cba","03065f3b1e344fb7922450c54a8deddd","8ab1697f34284a0c9ba357edb27bc10a","cc96063cc4c24800b4df4cab8b2e8262","3d6a61e4f56a4711a15e2aacf661b891","31f37cd81f7c42e9bd63a087b8fc6eb6","ba3da9b3729f4bf89723ade3b1d1ca76","cb361b81adc0491987c9362c63415cf7","547110ad417149f2b5af8327ad24acff","b226527e4fc64c71b1b44a4f0aed84bc","5d6e867554454f868dedefa1674073e0","3af56787a5154c0fbf0ec2d5f27875d5","c7afc8550faa46c384e49576fbd12993","1e60e87a95d9451b85992b0873712540","0abe2638beeb40ccb5c15ebd0e27eb47","d17e489531114a2388236cce9d16c238","3cba9f8e5bcd40e9bc5d13aaaca8885f","e19c4b1ca8ca43fa8e7d96d82e75d777","94c5f017a39648ec89f1c4c3730685c6","9ca182a1a9604f7d923ec98d45022a71","f1f8234b43c44099b4634fa6af2aca23","18dac4d42ef64ef9bc197c74488ab1b6","78ee3f4a79ab42259a6c6046f2088263","24ad90a597a5471588c92e2397237009","e56f8cb297b645f2b0d213bc31f6ceea","7c5f43967270495e8716557a9da6f2ef","d2fc97c8740f44479931dd8afef0ed07"]},"executionInfo":{"status":"ok","timestamp":1748609385028,"user_tz":-120,"elapsed":19221,"user":{"displayName":"Daria Zhukova","userId":"13302040269195955520"}},"outputId":"f9ffe391-30f6-49d0-902a-ae04a79c6223"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning: \n","The secret `HF_TOKEN` does not exist in your Colab secrets.\n","To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.\n","You will be able to reuse this secret in all of your notebooks.\n","Please note that authentication is recommended but still optional to access public models or datasets.\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["tokenizer_config.json:   0%|          | 0.00/25.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"79489b6aa3504dc3bf8df51c03e3a751"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["vocab.json:   0%|          | 0.00/899k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e7d88249e90a4c60afcb351abccce665"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["merges.txt:   0%|          | 0.00/456k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"50d224baaaf74639b108b174cd7e6767"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["tokenizer.json:   0%|          | 0.00/1.36M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"31f37cd81f7c42e9bd63a087b8fc6eb6"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["config.json:   0%|          | 0.00/481 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3cba9f8e5bcd40e9bc5d13aaaca8885f"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["RobertaForSequenceClassification(\n","  (roberta): RobertaModel(\n","    (embeddings): RobertaEmbeddings(\n","      (word_embeddings): Embedding(50265, 768, padding_idx=1)\n","      (position_embeddings): Embedding(514, 768, padding_idx=1)\n","      (token_type_embeddings): Embedding(1, 768)\n","      (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","      (dropout): Dropout(p=0.1, inplace=False)\n","    )\n","    (encoder): RobertaEncoder(\n","      (layer): ModuleList(\n","        (0-11): 12 x RobertaLayer(\n","          (attention): RobertaAttention(\n","            (self): RobertaSdpaSelfAttention(\n","              (query): Linear(in_features=768, out_features=768, bias=True)\n","              (key): Linear(in_features=768, out_features=768, bias=True)\n","              (value): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","            (output): RobertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","              (dropout): Dropout(p=0.1, inplace=False)\n","            )\n","          )\n","          (intermediate): RobertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): RobertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","            (dropout): Dropout(p=0.1, inplace=False)\n","          )\n","        )\n","      )\n","    )\n","  )\n","  (classifier): RobertaClassificationHead(\n","    (dense): Linear(in_features=768, out_features=768, bias=True)\n","    (dropout): Dropout(p=0.1, inplace=False)\n","    (out_proj): Linear(in_features=768, out_features=20, bias=True)\n","  )\n",")"]},"metadata":{},"execution_count":13}]},{"cell_type":"code","source":["#`classify_test(text: str) -> Tuple[str]` На вход – строка, на выход – tuple предсказанных меток из mlb.classes_.\n","def classify_test(text: str):\n","    inputs = tokenizer(\n","        text,\n","        return_tensors=\"pt\",\n","        truncation=True,\n","        padding=True\n","    )\n","    with torch.no_grad():\n","        logits = model(**inputs).logits\n","    # sigmoid + round → binary mask\n","    preds = torch.sigmoid(logits).round().cpu().numpy()\n","    return mlb.inverse_transform(preds)[0]\n"],"metadata":{"id":"hqxGDvsJvkcB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import glob, os\n","import pandas as pd\n","\n","DATA_DIR  = \"/content/drive/MyDrive/HCI Master courses/THESIS/EXP2_generated\"\n","\n","#read test df without labels\n","test_df_nl  = pd.read_csv(\"/content/drive/MyDrive/HCI Master courses/THESIS/optimal_test_no_labels.csv\")\n","\n","#`classify_test(text: str) -> Tuple[str]` На вход – строка, на выход – tuple предсказанных меток из mlb.classes_.\n","def classify_test(text: str):\n","    inputs = tokenizer(\n","        text,\n","        return_tensors=\"pt\",\n","        truncation=True,\n","        padding=True\n","    )\n","    with torch.no_grad():\n","        logits = model(**inputs).logits\n","    # sigmoid + round → binary mask\n","    preds = torch.sigmoid(logits).round().cpu().numpy()\n","    return mlb.inverse_transform(preds)[0]\n","\n","\n","csv_paths = glob.glob(os.path.join(DATA_DIR, \"*.csv\"))\n","\n","#for path in csv_paths:\n","    df = pd.read_csv(path)\n","    last_col = df.columns[-1]\n","\n","    # Классифицируем\n","    df[\"predicted_DA_labels\"] = df[last_col].astype(str).apply(classify_test)\n","\n","    # Берём исходное имя файла (без расширения) и используем его как суффикс\n","    base = os.path.splitext(os.path.basename(path))[0]\n","    out_name = f\"7440_{base}.csv\"\n","    out_path = os.path.join(DATA_DIR, out_name)\n","\n","    df.to_csv(out_path, index=False)\n","    print(f\"Saved {out_path}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"OXj80xtVPjdL","executionInfo":{"status":"ok","timestamp":1746017249733,"user_tz":-120,"elapsed":356343,"user":{"displayName":"Daria Zhukova","userId":"13302040269195955520"}},"outputId":"dced821f-899e-4cbd-ff6f-656161d3512c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Saved /content/drive/MyDrive/HCI Master courses/THESIS/EXP2_generated/7440_2203_mistral_alllines.csv\n","Saved /content/drive/MyDrive/HCI Master courses/THESIS/EXP2_generated/7440_2303_dolphin-llama3_alllines.csv\n","Saved /content/drive/MyDrive/HCI Master courses/THESIS/EXP2_generated/7440_2403_gemma2_alllines.csv\n","Saved /content/drive/MyDrive/HCI Master courses/THESIS/EXP2_generated/7440_2703_mistral_10.csv\n","Saved /content/drive/MyDrive/HCI Master courses/THESIS/EXP2_generated/7440_2703_mistral_6.csv\n","Saved /content/drive/MyDrive/HCI Master courses/THESIS/EXP2_generated/7440_2703_dolphin-llama3_6.csv\n","Saved /content/drive/MyDrive/HCI Master courses/THESIS/EXP2_generated/7440_2703_dolphin-llama3_10.csv\n","Saved /content/drive/MyDrive/HCI Master courses/THESIS/EXP2_generated/7440_3103_gemma2_10.csv\n","Saved /content/drive/MyDrive/HCI Master courses/THESIS/EXP2_generated/7440_3103_gemma2_6.csv\n"]}]},{"cell_type":"markdown","source":["Each of those checkpoint-* *italicised text* folders is a snapshot of my model’s weights at a particular training step (i.e. after that many optimizer updates). By default, Hugging Face’s Trainer (and WandB’s integration) will save a new checkpoint every time it runs an evaluation pass.\n","\n","\n","**Best-metric checkpoint**\n","\n","\n","If `load_best_model_at_end=True` is anabled or evaluated metrics (like F1) each epoch, pick the checkpoint that gave the highest validation F1 (or lowest validation loss)."],"metadata":{"id":"6K9YXM9EgSR5"}},{"cell_type":"code","source":["import pandas as pd\n","test_df_nl = pd.read_csv(\"/content/drive/MyDrive/HCI Master courses/THESIS/6_llines_del_utt.csv\")\n","\n","last_lines = (\n","    test_df_nl\n","    .drop_duplicates(subset=[\"dialog_id\"], keep=\"last\")\n","    .reset_index(drop=True)\n",")\n","\n","# Run your classifier on the 'context' column\n","#    (assumes classify_test, tokenizer, model & mlb are already defined)\n","last_lines[\"classified_context\"] = last_lines[\"context\"].astype(str).apply(classify_test)\n","\n","last_lines.to_csv(\n","    \"/content/drive/MyDrive/HCI Master courses/THESIS/classified_6_lines_del_utt.csv\",\n","    index=False\n",")\n","print(\"✅ Saved classified_6_lines_del_utt.csv to your THESIS folder\")"],"metadata":{"id":"dG03mreff3RI","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1748600195281,"user_tz":-120,"elapsed":36880,"user":{"displayName":"Daria Zhukova","userId":"13302040269195955520"}},"outputId":"17156b88-d375-43a3-a0c7-055721ffa80f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["✅ Saved classified_alllines_del_utt.csv to your THESIS folder\n"]}]},{"cell_type":"code","source":["import pandas as pd\n","df = pd.read_csv(\"/content/drive/MyDrive/HCI Master courses/THESIS/10_lines_del_utt.csv\")\n","\n","# Filter to only user utterances at turn 10\n","df = df[(df[\"speaker\"] == \"user\") & (df[\"turn\"] == 10)].copy()\n","\n","# Run classifier on the 'context' column\n","#    classify_test, tokenizer, model & mlb are already defined\n","df[\"classified_context\"] = df[\"context\"].astype(str).apply(classify_test)\n","\n","output_path = \"/content/drive/MyDrive/HCI Master courses/THESIS/classified_10_lines_del_utt.csv\"\n","df.to_csv(output_path, index=False)\n","print(f\"✅ Saved {output_path} (only user, turn=10 rows)\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_lzzGOfgPENL","executionInfo":{"status":"ok","timestamp":1748610397534,"user_tz":-120,"elapsed":22390,"user":{"displayName":"Daria Zhukova","userId":"13302040269195955520"}},"outputId":"6ddedee8-2b2f-4a4e-a90b-00454de3fecc"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["✅ Saved /content/drive/MyDrive/HCI Master courses/THESIS/classified_10_lines_del_utt.csv (only user, turn=10 rows)\n"]}]},{"cell_type":"code","source":["file_path = \"/content/drive/MyDrive/HCI Master courses/THESIS/classified_6_lines_del_utt.csv\"\n","df = pd.read_csv(file_path)\n","\n","n_dialogs = df['dialog_id'].nunique()\n","print(f\"Number of dialog_ids in optimal_test: {n_dialogs}\")\n","\n","# Clean up the classified_context column\n","#    - replace \",)\" → \"]\"\n","#    - then \"(\" → \"[\"\n","#    - then \")\" → \"]\"\n","df['classified_context'] = (\n","    df['classified_context']\n","      .str.replace(r',\\)', ']',   regex=True)\n","      .str.replace(r'\\(',   '[',   regex=True)\n","      .str.replace(r'\\)',   ']',   regex=True)\n",")\n","\n","df.to_csv(file_path, index=False)\n","print(f\"✅ Updated and saved {file_path}\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"FIsUtj32ys8N","executionInfo":{"status":"ok","timestamp":1748609495464,"user_tz":-120,"elapsed":30,"user":{"displayName":"Daria Zhukova","userId":"13302040269195955520"}},"outputId":"94258bc9-c494-4cf4-bc94-a6cae3a21a4b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Number of dialog_ids in optimal_test: 247\n","✅ Updated and saved /content/drive/MyDrive/HCI Master courses/THESIS/classified_6_lines_del_utt.csv\n"]}]}]}
